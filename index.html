<html>

<head>
    <meta charset="UTF-8">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-E8MQD4NT86"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'G-E8MQD4NT86');
    </script>

    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"/>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Rubik">


    <link rel="apple-touch-icon" sizes="57x57" href="favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
    <link rel="manifest" href="favicon/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="favicon/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <style>
  
        html {
            line-height: 1.5;
            -webkit-text-size-adjust: 100%;
            -moz-tab-size: 4;
            -o-tab-size: 4;
            tab-size: 4;
            font-family: "Rubik", sans-serif;
            font-feature-settings: normal;
            font-variation-settings: normal
        }

        body {
            margin: 0;
            line-height: inherit
        }

        a {
            all:unset;
        }

        a.link {
            text-decoration: underline;
            color:darkblue;
        }
        a.link:hover {
            color: red;
        }

        button,a {
            cursor: pointer
        }

        :disabled {
            cursor: default
        }

        img,svg,video,canvas,audio,iframe,embed,object {
            display: block;
            vertical-align: middle
        }

        img,video {
            max-width: 100%;
            height: auto
        }

        :root {
            --font-sans: sans-serif;
        
        }

        

        button {
            display:inline-flex;
            font-size:16px;
            padding:10px;
            font-weight:600;
            border-style:solid;
            border-radius: 12px;
        }

        button.gray {
            background-color:lightgray;
            border-color: gray;
        }

        button.green {
            background-color:lightgreen;
            border-color: green;
        }

        button:hover {
            background: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1));
        }

        .twitter-tweet {
            margin: auto;
        }
        #root>div {
            background: linear-gradient(to bottom, #d7e3fc, #faffff);
        }
    </style>

    <title>Iron Likes</title>

    <script>
        function is_chrome(){
            var isChromium = window.chrome;
            var winNav = window.navigator;
            var vendorName = winNav.vendor;
            var isOpera = typeof window.opr !== "undefined";
            var isIEedge = winNav.userAgent.indexOf("Edg") > -1;
            var isIOSChrome = winNav.userAgent.match("CriOS");

            if (isIOSChrome) {
              return false; //
            } else if(
                isChromium !== null &&
                typeof isChromium !== "undefined" &&
                vendorName === "Google Inc." &&
                isOpera === false &&
                isIEedge === false
            ) {
                return true;
            } else { 
                return false;
            }
        }

        function has_extension(){
            chrome.runtime.sendMessage("hbgbekianmmcbkenheennefojoemjaol", { message: "version" },
            function (reply) {
                if (reply && reply.version) {
                    
                } else {
                    $("#no_extension").show();
                }
            });
        }

        window.urls = [];
        function get_twitter_posts() {
            $.ajax({
                url: "https://raw.githubusercontent.com/IronLikes/debug/main/db",
                beforeSend: function (xhr) {
                    xhr.overrideMimeType("text/plain; charset=x-user-defined");
                }
            })
                .done(function (data) {
                    items = JSON.parse(data)["records"]["items"];
                    for (let item of items) {
                        window.urls.push(item["post_link"]);
                    }

                    next_post();
                });
        }


        get_twitter_posts();
        post_index = 0;

        function next_post() {
            if (post_index < window.urls.length) {
                $("#current_post").html('<blockquote class="twitter-tweet"><a href="' + window.urls[post_index] + '"></a></blockquote><script src="https://platform.twitter.com/widgets.js" charset="utf-8"/>');
                id = window.urls[post_index].split("/");
                id = id[id.length -1]
                $("#like_url").attr("href", "https://twitter.com/intent/like?tweet_id="+id);
                post_index += 1;
            } else {
                $("#current_post").html("No more posts for now.");
            }
        }

    </script>
</head>

<body>

    <div id="root">
        <div dir="rtl" style="width: 600px;max-width: 100%;margin: 20px auto;padding:10px;border: solid 2px lightgray;border-radius:12px;">
            
            <h1><img src="favicon/ms-icon-310x310.png" alt="Likes of Iron Logo" width="60" height="12" style="display: inline;"> לייקים של ברזל</h1>
            <h2>עושים לייקים, מפיצים את האמת</h2>

            <div style="margin-bottom: 10px;">
                <a class="link" target="_blank" href="https://chrome.google.com/webstore/detail/iron-likes-automation/hbgbekianmmcbkenheennefojoemjaol">
                    <span class="material-symbols-outlined" style="font-size:20px;vertical-align: middle;">
                    download
                    </span>מתקינים את התוסף לכרום</a>,
                לוחצים "הפעל",
                ונותנים למערכת לעשות לייקים לפוסטים אחד-אחד!
            </div>
            <div id="no_chrome" style="color: red;margin-bottom: 10px;display: none;">
                על מנת לבצע לייקים באופן אוטומטי, נא להשתמש בדפדפן Chrome ולהתקין את התוסף.
            </div>
            <div id="no_extension" style="color: red;margin-bottom: 10px;display: none;">
                <a class="link" target="_blank" href="https://chrome.google.com/webstore/detail/iron-likes-automation/hbgbekianmmcbkenheennefojoemjaol">
                    <span class="material-symbols-outlined" style="font-size:20px;vertical-align: middle;">
                    download
                    </span>נא להתקין את התוסף על מנת לבצע לייקים באופן אוטומטי!</a>
            </div>

            <div id="buttons">
                <button class="green" id="start_automation_button">
                    <span class="material-symbols-outlined">
                        play_pause
                    </span>
                    הפעל!
                </button>
                
                <button class="gray" onclick="$('#like_url')[0].click()">
                    <span class="material-symbols-outlined">
                        thumb_up
                    </span>
                    <a id="like_url" href="">
                        לייק
                    </a>
                </button>

                <button class="gray" onclick="next_post()" id="next_post_button">
                    <span class="material-icons">autorenew</span>
                    פוסט נוסף
                </button>
            </div>
            <div class="" id="current_post">
                                
            </div>
        </div>
    </div>

    <script>
        $( document ).ready(function() {
            if(! is_chrome()){
                $("#no_chrome").show();
            } else {
                has_extension();
            }
        });
    </script>
</body>

</html>
